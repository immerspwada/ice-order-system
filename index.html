<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LUCKY Delivery - สั่งน้ำแข็ง, แก๊ส, น้ำดื่ม</title>
  <meta name="description" content="LUCKY Delivery บริการจัดส่งน้ำแข็ง, แก๊ส, น้ำดื่ม รวดเร็วทันใจ">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#FFA726">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="mobile-web-app-capable" content="yes">
  <link rel="apple-touch-icon" href="icon-192x192.png">
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;700&family=Prompt:wght@500;700&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <nav class="stepper" aria-label="ขั้นตอนการสั่งซื้อ">
      <div class="step active"><span>1</span><div>เลือกสินค้า</div></div>
      <div class="step"><span>2</span><div>ข้อมูลลูกค้า</div></div>
      <div class="step"><span>3</span><div>ยืนยัน</div></div>
      <div class="step"><span>4</span><div>เสร็จสิ้น</div></div>
    </nav>
  </header>
  <main class="container">
    <h1 tabindex="0">เลือกสินค้า</h1>
    <section class="product-catalog">
      <form id="productForm">
        <div class="product-list"></div>
        <div class="cart-summary">
          <span id="totalPrice">รวม: ฿0</span>
          <button type="submit" class="btn-main" aria-label="ไปยังหน้ากรอกข้อมูลลูกค้า">ถัดไป</button>
        </div>
      </form>
      <div id="cartNotice" class="cart-notice"></div>
    </section>
  </main>
  <footer>
    LUCKY Delivery &copy; 2025
  </footer>
  <button id="pwaInstallBtn" style="display:none;position:fixed;bottom:2em;right:2em;z-index:9999;background:#FFA726;color:#fff;padding:1em 2em;border:none;border-radius:1em;font-weight:700;box-shadow:0 2px 12px #FFA72655;">ติดตั้งแอป</button>
  <script src="order.js" defer></script>
  <script>
    // PWA install prompt (ควรอยู่ที่นี่เท่านั้น)
    let deferredPrompt;
    const pwaBtn = document.getElementById('pwaInstallBtn');
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      pwaBtn.style.display = 'block';
    });
    pwaBtn && pwaBtn.addEventListener('click', async () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        if (outcome === 'accepted') {
          pwaBtn.style.display = 'none';
        }
        deferredPrompt = null;
      }
    });
    window.addEventListener('appinstalled', () => {
      pwaBtn.style.display = 'none';
    });
    // Service worker register (ควรอยู่ที่นี่เท่านั้น)
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(registration => console.log('Service Worker registered with scope:', registration.scope))
        .catch(error => console.error('Service Worker registration failed:', error));
    }
  </script>
</body>
</html>
