<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <!-- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏° CSS ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
  <style>
    body { font-family: 'Prompt', sans-serif; background: #fff8f0; margin: 0; padding: 0; }
    .btn-main {
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.1em;
      border: none;
      transition: 
        box-shadow 0.18s cubic-bezier(.4,0,.2,1),
        transform 0.12s cubic-bezier(.4,0,.2,1),
        background 0.18s cubic-bezier(.4,0,.2,1),
        color 0.18s cubic-bezier(.4,0,.2,1);
      outline: none;
      color: #fff;
      font-weight: 700;
      min-width: 120px;
      position: relative;
    }
    .btn-gradient {
      background: linear-gradient(90deg, #FFA726 0%, #FF7043 100%);
      box-shadow: 0 2px 8px rgba(255, 112, 67, 0.13);
      border: 1.5px solid #FFA726;
    }
    .btn-main:hover:not(:disabled), .btn-main:focus-visible:not(:disabled) {
      box-shadow: 0 4px 16px rgba(255, 112, 67, 0.22);
      transform: scale(1.045);
      z-index: 1;
    }
    .btn-main:active:not(:disabled) {
      transform: scale(0.97);
    }
    .btn-main.btn-disabled,
    .btn-main:disabled {
      background: #e0e0e0 !important;
      color: #bdbdbd !important;
      border-color: #e0e0e0 !important;
      cursor: not-allowed !important;
      box-shadow: none !important;
      opacity: 0.85;
    }
    .btn-spinner svg {
      animation: btn-spin 0.8s linear infinite;
      display: inline-block;
      vertical-align: middle;
    }
    @keyframes btn-spin {
      100% { transform: rotate(360deg);}
    }
    /* WCAG AA: Ensure text contrast on gradient */
    .btn-main, .btn-gradient {
      text-shadow: 0 1px 2px rgba(0,0,0,0.13);
    }
    .order-stepper {
      margin: 2.2em auto 2em auto;
      max-width: 420px;
      width: 100%;
      padding: 0 0.5em;
    }
    .stepper-list {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      list-style: none;
      padding: 0;
      margin: 0;
      position: relative;
      flex-wrap: wrap;
    }
    .stepper-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1 1 0;
      min-width: 70px;
      position: relative;
      z-index: 2;
      text-align: center;
      background: none;
    }
    .stepper-circle {
      width: 38px;
      height: 38px;
      border-radius: 50%;
      background: linear-gradient(135deg, #fff3e0 60%, #ffe0b2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 0.3em;
      box-shadow: 0 2px 8px #ffe0b2;
      position: relative;
      transition: box-shadow 0.2s;
    }
    .stepper-item.current .stepper-circle {
      background: linear-gradient(135deg, #FFA726 60%, #FF7043 100%);
      box-shadow: 0 4px 16px #ffb07444;
      border: 2.5px solid #fff;
    }
    .stepper-item.completed .stepper-circle {
      background: linear-gradient(135deg, #FFA726 60%, #FF7043 100%);
      box-shadow: 0 2px 8px #ffb07444;
      border: 2.5px solid #fff;
    }
    .stepper-num {
      color: #FFA726;
      font-weight: 700;
      font-size: 1.25em;
      line-height: 1;
    }
    .stepper-label {
      font-size: 1em;
      color: #FFA726;
      font-weight: 600;
      margin-top: 0.2em;
      letter-spacing: 0.2px;
      text-shadow: 0 1px 2px #fff8;
    }
    .stepper-item.current .stepper-label {
      color: #FF7043;
      font-weight: 800;
      text-shadow: 0 1px 2px #fff8;
    }
    .stepper-item.completed .stepper-label {
      color: #FFA726;
      opacity: 0.95;
    }
    .stepper-current-icon svg {
      display: block;
    }
    .stepper-line {
      flex: 0 0 24px;
      align-self: center;
      height: 38px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      width: 24px;
      min-width: 24px;
      z-index: 1;
      background: none;
      padding: 0;
      margin: 0;
    }
    .stepper-line-inner {
      display: block;
      width: 100%;
      height: 5px;
      border-radius: 3px;
      background: linear-gradient(90deg, #FFA726 0%, #FF7043 100%);
      opacity: 0.25;
      position: absolute;
      left: 0; top: 50%; transform: translateY(-50%);
      transition: opacity 0.3s;
      z-index: 1;
      animation: stepper-progress 1.1s cubic-bezier(.4,0,.2,1);
    }
    .stepper-item.completed ~ .stepper-line .stepper-line-inner,
    .stepper-item.current ~ .stepper-line .stepper-line-inner {
      opacity: 1;
      background: linear-gradient(90deg, #FFA726 0%, #FF7043 100%);
      animation: stepper-progress-done 0.7s cubic-bezier(.4,0,.2,1);
    }
    @keyframes stepper-progress {
      from { width: 0; opacity: 0.1;}
      to { width: 100%; opacity: 0.25;}
    }
    @keyframes stepper-progress-done {
      from { width: 0; opacity: 0.1;}
      to { width: 100%; opacity: 1;}
    }
    /* Responsive: stack on mobile */
    @media (max-width: 600px) {
      .order-stepper {
        max-width: 100vw;
        padding: 0 0.2em;
      }
      .stepper-list {
        flex-direction: column;
        align-items: stretch;
      }
      .stepper-item, .stepper-line {
        flex: none;
        min-width: 0;
        width: 100%;
        margin-bottom: 0.5em;
      }
      .stepper-line {
        height: 18px;
        width: 4px;
        min-width: 4px;
        margin: 0 auto;
      }
      .stepper-line-inner {
        width: 4px !important;
        height: 100%;
        background: linear-gradient(180deg, #FFA726 0%, #FF7043 100%);
      }
    }
  </style>
</head>
<body>
  <header>
    <nav class="stepper">
      <div class="step"><span>1</span><div>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</div></div>
      <div class="step"><span>2</span><div>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</div></div>
      <div class="step active"><span>3</span><div>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</div></div>
      <div class="step"><span>4</span><div>‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</div></div>
    </nav>
  </header>
  <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ -->
  <div id="orderSummary"></div>
  <div style="text-align:center;margin:2em 0;">
    <button onclick="downloadReceipt()" class="btn-main" style="background:#fff;color:#FFA726;border:1.5px solid #FFA726;padding:1em 2em;font-weight:700;font-size:1.1em;">
      üìÑ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à (PDF)
    </button>
  </div>
  <!-- ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ summary.js -->
  <script src="summary.js"></script>
  <!-- html2pdf.js CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <!-- ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ summary.js -->
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <script type="module">
    import { liffId } from './config.js';
    window.addEventListener('DOMContentLoaded', async () => {
      try {
        await liff.init({ liffId });
        if (!liff.isLoggedIn()) {
          liff.login({ redirectUri: window.location.href });
          return;
        }
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• session ‡∏Å‡πà‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î summary.js
        const customerInfo = JSON.parse(sessionStorage.getItem('customerInfo') || '{}');
        const orderProducts = JSON.parse(sessionStorage.getItem('orderProducts') || '{}');
        if (!customerInfo.name || Object.keys(orderProducts).length === 0) {
          alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
          window.location.href = 'form.html';
          return;
        }
        // ‡πÇ‡∏´‡∏•‡∏î summary.js ‡∏´‡∏•‡∏±‡∏á‡∏ú‡πà‡∏≤‡∏ô LIFF ‡πÅ‡∏•‡∏∞ session check
        const script = document.createElement('script');
        script.type = 'module';
        script.src = 'summary.js';
        document.body.appendChild(script);
      } catch (err) {
        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (err.message || err));
      }
    });
  </script>
</body>
</html>
